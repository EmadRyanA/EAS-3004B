<!-- Simple Graph utility to visualize the spectral flux-->
<body>
    <canvas id='fluxCanvas' width = "1024px;" height ="600px;"></canvas>
</body>

<textarea id='fluxInput'> </textarea>
<button type='button' id='fluxSubmit'>
  Go
</button>

<script>

let fluxArray = [];

let barWidth = 4;
let segmentWidth = 10000;

let currPos = 0;

let fluxCanvas = document.getElementById('fluxCanvas');
fluxCanvas.width = segmentWidth;
let fluxInput = document.getElementById('fluxInput');
let context = fluxCanvas.getContext("2d");

document.getElementById('fluxSubmit').onclick = function () {
    var lines = fluxInput.value;
    var linesSplit = lines.split("\n");
    for (line of linesSplit) {
        fluxArray.push(parseFloat(line));
    }
    drawFlux(0);
}

function drawFlux(pos) {
  context.clearRect(0, 0, fluxCanvas.width, fluxCanvas.height);
  
  context.lineWidth = 1;
  let mFactor = 512;
  for (var i = pos; i < pos + segmentWidth && i < fluxArray.length; i++) {
    context.strokeStyle = "white";  
    var grd = context.createLinearGradient(i * barWidth, 0, i * barWidth, mFactor);
    grd.addColorStop(0, "red");
    grd.addColorStop(0.5, "orange");
    grd.addColorStop(1, "#87ffff");

    context.fillStyle = grd;

    var scaledFlux = fluxArray[i] * mFactor;

    context.fillStyle = grd;
    context.fillRect(((i - pos) * barWidth), mFactor - scaledFlux, barWidth - 1, scaledFlux);
    context.fillStyle = "white";
    context.fillRect(((i - pos) * barWidth), mFactor - scaledFlux, 1, scaledFlux);

  }

  console.log("done");
}


</script>